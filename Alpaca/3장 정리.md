## 3장 역할, 책임, 협력

### 1. 협력

객체들이 기능 구현을 위해 수행하는 상호작용

- 73
  - 클래스와 상속은 객체들의 책임과 협력이 어느 정도 자리를 잡은 후에 사용할 수 있는 구현 메커니즘일 뿐
  - 어떤 역할과 책임이 필요한지를 고민하지 않은 채 너무 이른 시기에 구현에 초점을 맞추는 것은 변경하기 어렵고 유연하지 못한 코드를 낳는 원인
- 75
  - 메시지의 전송를 통해 객체 사이의 협력을 이루는데 메시지를 받은 객체는 이 메시지를 어떻게 처리할지에 대한 것을 스스로 결정한다. 이를 통해 해당 객체가 자율적인 존재라는 것을 알 수 있다.

- 76
  - 객체의 자율성을 보장하기 위해서는 필요한 정보와 정보에 기반한 행동을 같은 객체 안에 모아놓아야 한다.
  - 객체를 자율적으로 만드는 가장 기본적인 방법은 내부 구현을 **캡슐화**하는 것
- 77
  - 객체의 상태는 그 객체가 행동을 수행하는 데 필요한 정보가 무엇인지로 결정. 객체는 자율적인 존재기 때문에 행동에 필요한 상태도 함께 가지고 있어야 함.
    - 이 객체를 사용하는 서비스 객체가 어떤 행동을 사용할지, 즉 의존성을 결정하면 서비스 구현에 있어 유연성을 크게 잡을 수 있음. 하위가 구현을 결정하기 때문에 의존성의 역전이 일어남.
  - 상태는 객체가 행동하는 데 필요한 정보에 의해 결정되고 행동은 협력 안에서 객체가 처리할 메시지로 결정됨. 결과적으로 **객체가 참여하는 협력이 객체의 행동과 상태 모두를 결정**. 이로써 협력은 객체를 설계하는 데 필요한 일종의 문맥을 제공.

### 2. 책임

협력에 참여하기 위해 객체가 수행하는 행동

- 78
  - 책임이란 객체에 의해 정의되는 **응집도** 있는 행위의 집합으로, 객체가 유지해야 하는 정보와 수행할 수 있는 행동에 대해 개략적으로 서술한 문장이다.
  - 객체의 책임은 '하는 것'과 '아는 것'으로 나뉘게 됨.
- 79
  - 협력 안에서 객체에게 할당한 책임이 외부의 인터페이스와 내부의 속성을 결정한다.
  - 책임은 메시지보다 추상적이고 개념적으로 더 큰 개념이며 중요한 것은 책임의 관점에서 '아는 것'과 '하는 것'이 밀접하게 연관되어 있다는 것이다. 왜냐하면 **객체는 맡은 책임을 수행하는 데 필요한 정보를 함께 알아야 할 책임 또한 가지고** 있다.
  - 결국 이러한 책임을 잘 할당하는 것이 객체지향 설계의 핵심
- 83
  - 객체지향 설계는 협력에 필요한 메시지를 찾고 메시지에 적절한 객체를 선택하는 반복적인 과정을 통해 이뤄진다. 그리고 이런 메시지가 메시지를 수신할 객체의 책임을 결정한다.
  - 결정된 메시지가 객체의 퍼블릭 인터페이스를 구성한다.
- 84
  - 객체에게 책임을 할당하는 데 필요한 메시지를 먼저 식별하고 메시지를 처리할 객체를 나중에 선택했다는 것이 중요하다.
    - 최소한의 인터페이스, 추상적인 인터페이스를 가질 수 있게 함
- 85
  - 같이 이야기할 주제: 초보자들은 먼저 객체에 필요한 상태가 무엇인지를 결정하고, 그 후에 상태에 필요한 행동을 결정하지만 이런 방식은 객체의 내부 구현이 객체의 퍼블릭 인터페이스에 노출되도록 만들기 때문에 캡슐화를 저해한다.

### 3. 역할

객체가 어떤 특정한 협력 안에서 수행하는 책임의 집합

- 86
  - 협력을 모델링할 때는 특정한 객체가 아니라 역할에게 책임을 할당한다고 생각하는 것이 좋음
- 88
  - 역할은 다른 것으로 교체할 수 있는 책임의 집합이다. => 결국 추상화...!
- 90
  - 어떤 협력에서 하나 이상의 객체가 동일한 책임을 수행할 수 있다면 역할은 서로 다른 방법으로 실행할 수 있는 책임의 집합이 된다.
  - 협력에 적합한 책임을 수행하는 대상이 한 종류라면 객체로 간주!
- 91
  - 하지만 대부분의 경우에 어떤 것이 역할이고 어떤 것이 객체인지가 또렷하게 드러나지는 않을 것. 특히 설계 초반에는 이러한 결정을 내리기가 더욱 어려울 것.
  - 저자의 개인적인 견해는 설계 초반에 적절한 책임과 협력의 큰 그림을 탐색하되 애매한 부분은 객체로 시작하여 공통적인 책임을 발견하고 이를 역할로 분리하는 것이 좋은 방법이라고 소개하고 있다.

결국 공통적인 책임을 묶는 큰 틀이 역할이다. 큰 틀은 다시 말해 추상화 작업이며 이를 통해 두 가지 이점을 얻는다.

- 상위 수준에서 협력의 흐름을 볼 수 있다.

- 유연한 설계를 할 수 있다. 역할은 일종의 슬롯으로서 동작하며 이를 구현할 방법으로는 추상 클래스와 인터페이스가 있다.

  - > Swift로는 Protocol이 이 두 역할을 다 한다고 볼 수 있다.
    >
    > 네이버 영영사전: Protocol is a system of rules about the correct way to act in formal situations.
    >
    > 결국 Protocol이 역할의 의미를 가진다.

