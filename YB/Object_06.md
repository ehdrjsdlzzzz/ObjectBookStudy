# 메시지와 인터페이스

- p175
    - 객체지향 애플리케이션의 가장 주요한 재료는 클래스가 아니라 객체들이 주고받는 메시지다.

### 협력과 메시지

- p176

    - **클라이언트-서버 모델**
        - 협력은 어떤 객체가 다른 객체에게 무언가를 요청할 때 시작된다.
        - 두 객체 사이에 협력 관계를 설명하기 위해 사용하는 전통적인 메타포는 `클라이언트-서버 모델` 이다.
        - 협력 안에서 메시지를 전송하는 객체를 `클라이언트` 메시지를 수신하는 객체는 `서버` 라고 부른다
        - 객체는 협력을 통해 더 많은 책임을 수행하며, 협력을 가능하게 해주는 매개체가 바로 메시지이다.

- p177~181

    - **메시지와 메시지전송**

        ```swift
        //          수신자     오퍼레이션 명    인자
        swift:   condition.isSatisfiedBy(screening)
        Obj-c:  [condition isSatisfiedBy: screening]
        ```

    - 메시지

        - 객체들이 협력하기 위한 의사소통 수단
        - 전송하는 객체를 메시지 전송자 / 수신하는 객체를 메시지 수신자 라고 부른다
        - 오퍼레이션 명과 인자로 구성됨

    - **메시지와 메서드**

        - 실제로 실행되는 함수 또는 프로시저를 메서드라고 한다.
        - 동일한 메시지를 전송하더라도 객체의 타입에 따라 실행되는 메서드가 달라질 수 있다.

    - **퍼블릭 인터페이스**

        - 객체가 의사소통을 위해 외부에 공개하는 메시지의 집합

    - **오퍼레이션**

        - 퍼블릭 인터페이스에 포함된 메시지
        - 수행 가능한 행동에 대한 추상화다.
        - 메시지를 수신했을 때 실행되는 코드는 메서드

    - **시그니처**
        - 오퍼레이션이나 메서드의 명세를 나타낸 것으로, 이름과 인자목록을 포함한다. 

### 인터페이스와 설계 품질

- p181

    - 책임 주도 설계 방법은 메시지를 먼저 선택함으로써 협력과는 무관한 오퍼레이션이 인터페이스에 스며드는 것을 방지한다.

- p183~186

    - **디미터법칙**
        - 객체의 내부 구조에 대한 결합으로 인해 발생하는 설계 문제를 해결하기 위해 제안된 원칙
        - 객체 내부의 구조에 강하게 결합되지 않도록 협력 경로를 제한하라는 것이다(인접한 이웃하고만 말하라)
        - 오직 하나의 도트만 사용하라
        - 디미터 법칙을 따르면 불필요한 어떤 것도 다른 객체에게 보여주지 않으며, 다른 객체의 구현에 의존하지 않는 코드를 말한다.
        - 메시지 수신자의 내부 구조가 전송자에게 노출되지 않으며, 메시지 전송자는 수신자의 내부 구현에 결합되지 않는다.
        - 객체의 내부 구조를 묻는 메시지가 아니라 수신자에게 무언가 시키는 메시지가 더 좋은 메시지라고 속삭인다.

- p186~187

    - **묻지 말고 시켜라**
        - 객체의 상태에 관해 묻지 말고 원하는 것을 시켜야 한다
        - 상태를 묻는 오퍼레이션을 행동을 요청하는 오퍼레이션으로 대체함으로써 인터페이스를 향상시켜라.
        - 협력을 설계하고 객체가 수신할 메시지를 결정하는 매 순간 묻지 말고 시켜라 원칙 과 디미터 법칙을 머릿속에 떠올리는 것은 퍼블릭 인터페이스의 품질을 향상시킬 수 있는 좋은 습관이다.

- p188

    - **의도를 드러내는 인터페이스**

        - 메서드를 명명하는 방법

            - 메서드가 작업을 어떻게 수행하는지를 나타내도록 이름짓는 것이다.

            - 어떻게가 아니라 무엇을 하는지를 드러내는 것이다.

                > 어떻게는 내부구현

- p190

    - 의도를 드러내는 인터페이스를 한마디로 요약하면 구현과 관련된 모든 정보를 캡슐화하고 객체의 퍼블릭 인터페이스에는 협력과 관련된 의도만을 표현해야 한다는 것이다.

- p197

    - 객체 자신이 아닌 클라이언트의 의도를 표현하는 이름을 가져야한다.

        - `sellto, hold, buy` O
        - `setTicket` X

        > 그 객체가 해야하는 것

### 원칙의 함정

- p198
    - **디미터 법칙은 하나의 도트를 강제하는 규칙이 아니다.**
        - `IntStream.of(1, 15, 20, 3, 9).filter(x -> x > 10).distinct().count()` 다음 구문은 연속적인 dot을 사용하며 기차충돌이 나타나는것으로 보이지만 디미터 법칙을 위반하지 않는다.
        - 디미터법칙은 결합도와 관련된것이며, 이 결합도가 문제되는것은 내부의 구현이 외부로 노출되는 경우를 말한다..
        - 위 구문은 IntStream자체를 내부적으로 변환하면서 자신을 변형하고있다. 내부에서 어떻게 동작하는지 알 수 없다.

### 명령-쿼리 분리 원칙

- p202
    - 명령과 쿼리는 객체의 인터페이스 측면에서 프로시저와 함수를 부르는 또 다른 이름이다.
    - **명령**
        - 객체의 상태를 수정하는 오퍼레이션
        - 프로시저
    - **쿼리**
        - 객체와 관련된 정보를 반환하는 오퍼레이션
        - 함수
        - 쿼리는 객체의 상태를 반환할 수 있지만 상태를 변경해서는 안된다
- p211
    - **명령-쿼리 분리와 참조 투명성**
        - 참조 투명성
            - 동일한 입력에대해서 동일한 결과를 반환
- p214
    - **책임에 초점을 맞춰라**
        - **디미터법칙**	
            - 협력이라는 컨텍스트 안에서객체보다 메시지를 먼저 결정하면 두 객체 사이의 구조적인 결합도를 낮출 수 있다.
            - 메시지가 객체를 선택하게 함으로써 의도적으로 디미터 법칙을 위반할 위험을 최소화 할 수 있다.
        - **묻지 말고 시켜라**
            - 메시지를 먼저 선택하면 묻지 말고 시켜라 스타일에 따라 협력을 구조화하게 된다.
            - 클라이언트의 관점에서 메시지를 선택하기 때문에 필요한 정보를 물을 필요 없이 원하는 것을 표현한 메시지를 전송하면 된다.
        - **의도를 드러내는 인터페이스**
            - 메시지를 먼저 선택한다는 것은 메시지를 전송하는 클라이언트의 관점에서 메시지의 이름을 정한다는 것이다.
            - 당연히 그 이름에는 클라이언트가 무엇을 원하는지 그 의도가 드러날 수 밖에없다.
        - **명령-쿼리 분리 원칙**
            - 메시지를 먼저 선택한다는 것은 협력이라는 문맥 안에서 객체의 인터페이스에 관해 고민한다는것을 의미한다.